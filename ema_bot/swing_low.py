import numpy as np
import matplotlib.pyplot as plt
import pandas as pd

data = [0.2988, 0.2986, 0.2992, 0.2994, 0.3004, 0.3004, 0.2999, 0.2998, 0.3, 0.2998, 0.2997, 0.2998, 0.2988, 0.2984, 0.2989, 0.2986, 0.2987, 0.2988, 0.2991, 0.3001, 0.3004, 0.2998, 0.2997, 0.2997, 0.3008, 0.3005, 0.3005, 0.3004, 0.2997, 0.2993, 0.2986, 0.2984, 0.2985, 0.2985, 0.2987, 0.2983, 0.2991, 0.2997, 0.2993, 0.2993, 0.2994, 0.2996, 0.3, 0.2999, 0.3004, 0.3001, 0.2992, 0.2989, 0.2986, 0.2987, 0.2985, 0.298, 0.2979, 0.2967, 0.2968, 0.2969, 0.2967, 0.2975, 0.2976, 0.2979, 0.2977, 0.2977, 0.2979, 0.2975, 0.2972, 0.2977, 0.2977, 0.2981, 0.2981, 0.298, 0.298, 0.2981, 0.2979, 0.2976, 0.2977, 0.2983, 0.2986, 0.2986, 0.2988, 0.2989, 0.2988, 0.2986, 0.2984, 0.2991, 0.2987, 0.2988, 0.2988, 0.2995, 0.2998, 0.2999, 0.2996, 0.2979, 0.2979, 0.2973, 0.2973, 0.2973, 0.2974, 0.2971, 0.2971, 0.2974, 0.2965, 0.2964, 0.2966, 0.2963, 0.2962, 0.2965, 0.2967, 0.2959, 0.2958, 0.296, 0.2962, 0.2961, 0.295, 0.2945, 0.295, 0.2946, 0.2944, 0.294, 0.294, 0.294, 0.2942, 0.2943, 0.2945, 0.2945, 0.2937, 0.2939, 0.2941, 0.2943, 0.2943, 0.2927, 0.2922, 0.2922, 0.2921, 0.2913, 0.2908, 0.2907, 0.2908, 0.2903, 0.2902, 0.2902, 0.2902, 0.2896, 0.2897, 0.2904, 0.2899, 0.2897, 0.2901, 0.2901, 0.29, 0.2899, 0.2901, 0.2906, 0.2908, 0.2891, 0.2888, 0.2884, 0.2877, 0.2877, 0.2868, 0.287, 0.2866, 0.2874, 0.2876, 0.287, 0.2873, 0.2875, 0.2869, 0.2869, 0.2873, 0.2877, 0.2869, 0.2866, 0.2858, 0.2856, 0.2863, 0.2864, 0.285, 0.2843, 0.2824, 0.2817, 0.2825, 0.2831, 0.2835, 0.2823, 0.2817, 0.2814, 0.2812, 0.2814, 0.2817, 0.2821, 0.2817, 0.2815, 0.2814, 0.2815, 0.2815, 0.2813, 0.2802, 0.2796, 0.2797, 0.2806]

df = pd.DataFrame(data, columns=['low'])

# # swing low
periods = 6
swing_lows = []
df['sw_low'] = np.nan
for i in range(len(df)):
    if i >= periods:
        if min(df['low'].iloc[i-periods:i+1+periods]) == df['low'].iloc[i]:
            swing_lows.append(df['low'].iloc[i])
            df['sw_low'].iloc[i] =  df['low'].iloc[i]
            
df['sw_high'] = np.nan
for i in range(len(df)):
    if i >= periods:
        if max(df['low'].iloc[i-periods:i+1+periods]) == df['low'].iloc[i]:
            swing_lows.append(df['low'].iloc[i])
            df['sw_high'].iloc[i] =  df['low'].iloc[i]

print(len(swing_lows))
print(swing_lows)

colors = plt.rcParams['axes.prop_cycle'].by_key()['color']

plt.figure(figsize=(15, 8))
plt.plot(df['low'], zorder=0)
plt.scatter(df.index, df['sw_high'], s=100,
  label='swing high', marker='v', c=colors[1])
plt.scatter(df.index, df['sw_low'], s=100,
  label='swing low', marker='^', c=colors[2])
plt.xlabel('Index')
plt.ylabel('Price ($)')
plt.legend()
plt.show()
